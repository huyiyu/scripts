# PBAC 多维权限设计
## 项目背景
### 信息安全问题
1. 个人信息泄漏，黑产灰产规模化。
2. 勒索病毒。
3. 黑客攻击。
### 多维度权限设计
基于角色的权限设计无法满足多维度复杂的业务需求。 


### 企业级
1. 无标准化产品,无合理落地经验，CFN CAS 等产品不足
2. 中心内部存在多套系统,使用不同的权限管理策略

## 项目优势
### 内核设计优势
| 设计方案 | 配置过程 | 执行过程 | 使用成本 | 多维验证 | 灵活程度 |
| ---- | ---- | ---- | ---- | ---- | ---- |
| RBAC | 低    | 低    | 低    | 不满足  | 低    |
| PBAC | 高    | 高    | 高    | 满足   | 高    |



#### 配置过程差别
RBAC: 录入系统需要被访问的资源 -> 创建允许访问对应资源的角色 -> 给角色分配权限 -> 为用户分配角色
PBAC: 录入系统需要被访问的资源 -> 创建允许访问对应资源的策略 -> 为策略添加不同规则(时间,地点,岗位,条线) ->  计算当前用户在不同规则中是否通过

#### 执行过程的差别
RBAC: 确定访问资源 -> 获取资源允许的角色列表 -> 获取当前访问用户分配的角色列表 -> 判断相交确定通过或拒绝
PBAC: 确定访问资源 -> 选择资源对应的策略执行器 (唯一) -> 执行策略中的规则 -> 对规则结果进行评估确定通过或拒绝

### 架构设计优势
1. SDK方案: 写一个鉴权模块-> 关联应用引入 -> 执行代码
2. 微服务方案 写一个鉴权模块 -> 网关引入 -> 

## 项目落地案例分享
### 基础概念
* **用户**:访问该系统的用户
* **资源**: 对系统可访问的功能进行建模,简单理解一个页面的按钮就是一个访问资源
* **规则**：一个维度判断模块,为输入的资源,和访问当前资源的用户做一个计算,得出一个是或否的结果
* **规则执行器**: 是规则实体的一个属性,使用代码或脚本进行编写,用于实际执行规则计算的逻辑
* **执行器配置**: 执行器运行过程中需要的参数,如某个固定地点,某个时间集合,某个岗位

* **策略**: 一组规则的集合,用于对相似判断规则的的资源进行分类,以及对一组规则进行排序,规则之间关系冲突进行解决

* **属性集合**: 对于某个策略中的一组规则,



* **属性**: 对于某个规则,RBAC中的角色就是一种属性



* **用户属性**: 某个用户在某个规则中的属性,
* **规则配置**: 






### 数据架构
用户 -> 用户关联属性集 -> 属性集 -> 属性集详情-> 规则

### 技术架构
JWT + 网关 + 认证鉴权服务 + 缓存 + 消息
### 元数据录入
录入系统需要被访问的资源 -> 创建允许访问对应资源的策略 -> 为策略添加不同规则(时间,地点,岗位,条线) -> 定义关联属性集合 -> 用户关联属性集合 -> 执行策略
### 执行过程
确定访问资源 -> 选择资源对应的策略执行器 (唯一) -> 获取适配当前用户当前策略的属性集 (唯一) -> 执行策略中的规则 -> 评估策略结果


### FAQ

## 总结