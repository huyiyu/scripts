# Easy Deploy 架构设计



## 一. 概述

>   大部分应用都在拥抱云原生,少部分应用仍然使用 systemd,docker,docker-compose,甚至 java -jar 部署,easy-deploy的设计初衷是:"帮助愿意上k8s的用户以微服务的视角用好k8s,帮助不愿意迁移上云的用户管理他们的应用体系”。主要工作内容是将平时下发容易遗漏的工作统一,让机器按照已经预设好的工作流或者SOP按部就班的执行,减少重复劳动。



## 二. 概念

- 系统: 表示某个完整的服务集合。
- 环境: 对于一个系统,可在不同的环境中部署,以提供测试验证能力,方便发布生产,一般的部署环境有 DEV,SIT,UAT,PRO等。
- 目标: 一个部署环境的具体体现,如k8s集群, docker-compose,systemd 都是不同的部署目标。
- 应用: 一个应用系统由一个或多个应用组成
- 部署态: 一个应用在某个具体环境中的体现
- 实例： 部署态中相同的应用的多个提供服务的对象
- 制品: 应用部署所需的介质,可以是jar 包,docker 镜像等
- 数据库: 一个系统应用对应的数据库,可能有0个或多个
- 属性: 应用在不同环境中需要区分的不同配置信息称为属性,常见的有基本属性和自定义属性的区别。
- 模板: 对不同应用部署目标,所对应的部署形式的清单。
- 清单: 单个应用在特定环境中所有属性组成的有机整体称为部署清单,部署清单 = 模板 + 属性。
- 凭据: 用于身份认证的文本片段,常见的如密码,ssh 私钥,kubernetes config, jwt 私钥,secretKey 都属于这个范畴。
- 客户端: 部署到控制节点用于查询,提交部署指令的可执行性文件。
- 服务端: 实际部署执行流程,接收部署指令,提供客户端访问方式的应用。

## 三.数据结构

## 四.工作流程

## 五.应用功能

- [x] 系统导入
- [x] 数据比对(结构比对 vs 执行过程比对) && 数据同步(包含字典同步,结构同步)
- [x] 发布(滚动发布,灰度发布,异常回退等功能)
- [x] 下发流程编排
- [x] **实用性工具**:  复杂密码生成,TLS 密钥生成
- [x] 交互式控制台



## 六.最佳实践




## 七.技术选型

- graalvm native
- picocli
- spring shell